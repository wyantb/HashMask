<!DOCTYPE html>
<html lang="en">
<head>
  <title>Hash Mask - Options</title>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="icons/16.png">
  <link rel="stylesheet" href="reset.css" type="text/css">
  <link rel="stylesheet" href="options.css" type="text/css">
  <script type="text/javascript" src="util.js"></script>
  <script type="text/javascript" src="lib/jquery-1.7.1.js"></script>
  <script type="text/javascript" src="lib/jquery.sparkline.min.js"></script>
  <script type="text/javascript" src="lib/jquery.hashmask.js"></script>
  <script type="text/javascript" src="lib/jcade.js"></script>
  <script type="text/javascript" src="inject.js"></script>
</head>

<body>
  <div class="cont1">
    <h1>Hash Mask Settings</h1>

    <div class="cont2" id="demo">
      <h2>Hash Mask Preview</h2>
      <input type="password" autofocus="autofocus">
    </div>
    
    <div class="cont2">
      <h2>Security Settings</h2>
      <!-- Put a nice description of all the implications of these in at some point. -->

      <div class="cont3">
        <h3>Current Salt Value</h3>
        Current Salt: <input id="salt-value" type="text"><br>
        <button id="save-btn" type="button" onclick="save()">Save</button>
        <button id="reload-btn" type="button" onclick="reload_salt()">Reload</button>
        <button id="show-btn" type="button" onclick="show()">Show Stored Salt</button>
      </div>

      <div class="cont3">
        <h3>Hash Algorithm</h3>
        <!-- Broken, requires investigation! -->
        <!--
        <span class="hash">
          <input type="radio" id="ripemd160" name="hash" value="ripemd160">
          <label for="ripemd160">RIPEMD-160</label>
        </span>
        -->
        <span class="hash">
          <input type="radio" id="sha1" name="hash" value="sha1">
          <label for="sha1">SHA-1</label>
        </span><span class="hash">
          <input type="radio" id="sha256" name="hash" value="sha256">
          <label for="sha256">SHA-256</label>
        </span><span class="hash">
          <input type="radio" id="whirlpool" name="hash" value="whirlpool">
          <label for="whirlpool">Whirlpool</label>
        </span>
      </div>
    </div>
  </div>

  <script>
    // Place initial salt value into salt input field once DOM is ready
    $(function () {
      reload_salt();
      reload_hash();

      $(".hash input").click(function (e) {
        var hash = localStorage.hash = e.target.value;

        // Update hash algorithm about to be used by hashmask
        $.hashmask.settings.hashUsed = hash;
        $.hashmask.settings.hashFunction = $.hashmask.hashAlgorithms[hash];

        // Refresh the hashmask on the page
        $(".hashmask-sparkline").remove();
        $("input[type=password]").hashmask();
      });
    });

    // Save the user's salt
    function save () {
      localStorage.salt = $('#salt-value').val();
    }

    // Load the user's current salt into the salt input field
    function reload_salt () {
      $('#salt-value').val(localStorage.salt);
    }

    // Load the user's current hash into a hash radio button
    function reload_hash () {
      var hash = localStorage.hash;

      $("#" + hash).click();
    };

    // Anytime the user changes it, update salt (bad idea by default)
    //$('#salt-value').keyup(function (e) {
    //  localStorage.salt = $(this).val();
    //});

    // Show the user's current salt
    function show () {
      alert("Stored value: " + localStorage.salt);
    }
  </script>
</body>
</html>
